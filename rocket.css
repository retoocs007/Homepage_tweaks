/* === ROCKET === START === */

:root{
  --rocket-size: 14px;
  --rocket-angle: 300deg;
  --leg: 35s;
  --legs: calc(var(--leg) * 8);
  --rocket-steps: 240;
}

html, body { height: 100%; }
body { position: relative; }

body::after{
  content:"";
  position: fixed;
  top: 0; left: 0;
  width: var(--rocket-size);
  height: calc(var(--rocket-size) * 2);
  z-index: 6;
  pointer-events: none;
  background:
    url("data:image/svg+xml;utf8,\
      <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 100'>\
        <style>.s{stroke:%23000;stroke-width:2;stroke-linejoin:round;stroke-linecap:round}</style>\
        <path class='s' d='M25 3c11 10 16 28 14 51H11C9 31 14 13 25 3Z' fill='%23ececec'/>\
        <path class='s' d='M25 3 36 16 14 16Z' fill='%23ff4d4d'/>\
        <circle class='s' cx='27' cy='36' r='8' fill='%238aa0b6'/>\
        <circle class='s' cx='27' cy='36' r='5.5' fill='%23188cf0'/>\
        <path class='s' d='M11 54 2 66 14 63Z' fill='%23ff4d4d'/>\
        <path class='s' d='M39 54 48 66 36 63Z' fill='%23ff4d4d'/>\
        <rect class='s' x='20' y='54' width='10' height='9' rx='2' ry='2' fill='%23999'/>\
        <path class='s' d='M25 63 15 77 25 72 35 77Z' fill='%23ffa62b'/>\
      </svg>") center / contain no-repeat;

  /* performance hints */
  will-change: transform, opacity;
  contain: paint;
  backface-visibility: hidden;
  transform-origin: center;
}

/* ===== Modern path: animatable custom props + stepped transform ===== */
@supports (property(--ox)) {

  @property --ox { syntax: '<length-percentage>'; inherits: false; initial-value: 108vw; }
  @property --oy { syntax: '<length-percentage>'; inherits: false; initial-value: 82vh; }
  @property --tx { syntax: '<length-percentage>'; inherits: false; initial-value: 0vw; }
  @property --ty { syntax: '<length-percentage>'; inherits: false; initial-value: 0vh; }

  body::after{
    transform:
      translate3d(calc(var(--ox) + var(--tx)), calc(var(--oy) + var(--ty)), 0)
      rotate(var(--rocket-angle));
    animation:
      /* per-leg motion done in discrete steps -> fewer compositor updates */
      fly var(--leg) steps(var(--rocket-steps), end) infinite,
      /* snapped re-seeding of start positions (8 legs) */
      offsets var(--legs) steps(1, end) infinite;
  }

  /* Move across screen; hide only during the teleport frames */
  @keyframes fly{
    0%   { --tx: 0vw; --ty: 0vh;   opacity: 1; }
    98%  {                        opacity: 1; }
    99%  {                        opacity: 0; } /* hide before jump */
    100% { --tx: -200vw; --ty: -200vh; opacity: 0; } /* off far corner */
  }

  /* 8 start offsets (kept close so rocket appears quickly each leg) */
  @keyframes offsets{
    0%,     12.499% { --ox: 108vw; --oy: 82vh; }
    12.5%,  24.999% { --ox: 120vw; --oy: 70vh; }
    25%,    37.499% { --ox: 102vw; --oy: 96vh; }
    37.5%,  49.999% { --ox: 128vw; --oy: 78vh; }
    50%,    62.499% { --ox: 110vw; --oy: 88vh; }
    62.5%,  74.999% { --ox: 134vw; --oy: 80vh; }
    75%,    87.499% { --ox: 118vw; --oy: 100vh; }
    87.5%,  100%    { --ox: 112vw; --oy: 74vh; }
  }
}

/* ===== Fallback: single keyframes set (no @property), still GPU + stepped ===== */
@supports not (property(--ox)) {

  body::after{
    animation: rocketMulti var(--legs) linear infinite both;
  }

  /* We run 8 legs in one timeline; opacity goes 0?1 after the jump.
     Motion is stepped to reduce compositor updates. */
  @keyframes rocketMulti{

    /* LEG 1 */
    0%   { opacity:0; transform: translate3d(108vw,82vh,0) rotate(var(--rocket-angle)); }
    0.1% { opacity:1; transform: translate3d(108vw,82vh,0) rotate(var(--rocket-angle)); }
    12%  {           transform: translate3d(-92vw,-118vh,0) rotate(var(--rocket-angle)); animation-timing-function: steps(var(--rocket-steps), end); }
    12.1%{ opacity:0; }

    /* LEG 2 */
    12.5%{ opacity:0; transform: translate3d(120vw,70vh,0) rotate(var(--rocket-angle)); }
    12.6%{ opacity:1; transform: translate3d(120vw,70vh,0) rotate(var(--rocket-angle)); }
    24%  {           transform: translate3d(-80vw,-130vh,0) rotate(var(--rocket-angle)); animation-timing-function: steps(var(--rocket-steps), end); }
    24.1%{ opacity:0; }

    /* LEG 3 */
    25%  { opacity:0; transform: translate3d(102vw,96vh,0) rotate(var(--rocket-angle)); }
    25.1%{ opacity:1; transform: translate3d(102vw,96vh,0) rotate(var(--rocket-angle)); }
    36%  {           transform: translate3d(-98vw,-104vh,0) rotate(var(--rocket-angle)); animation-timing-function: steps(var(--rocket-steps), end); }
    36.1%{ opacity:0; }

    /* LEG 4 */
    37.5%{ opacity:0; transform: translate3d(128vw,78vh,0) rotate(var(--rocket-angle)); }
    37.6%{ opacity:1; transform: translate3d(128vw,78vh,0) rotate(var(--rocket-angle)); }
    48%  {           transform: translate3d(-72vw,-122vh,0) rotate(var(--rocket-angle)); animation-timing-function: steps(var(--rocket-steps), end); }
    48.1%{ opacity:0; }

    /* LEG 5 */
    50%  { opacity:0; transform: translate3d(110vw,88vh,0) rotate(var(--rocket-angle)); }
    50.1%{ opacity:1; transform: translate3d(110vw,88vh,0) rotate(var(--rocket-angle)); }
    60%  {           transform: translate3d(-90vw,-112vh,0) rotate(var(--rocket-angle)); animation-timing-function: steps(var(--rocket-steps), end); }
    60.1%{ opacity:0; }

    /* LEG 6 */
    62.5%{ opacity:0; transform: translate3d(134vw,80vh,0) rotate(var(--rocket-angle)); }
    62.6%{ opacity:1; transform: translate3d(134vw,80vh,0) rotate(var(--rocket-angle)); }
    72%  {           transform: translate3d(-66vw,-120vh,0) rotate(var(--rocket-angle)); animation-timing-function: steps(var(--rocket-steps), end); }
    72.1%{ opacity:0; }

    /* LEG 7 */
    75%  { opacity:0; transform: translate3d(118vw,100vh,0) rotate(var(--rocket-angle)); }
    75.1%{ opacity:1; transform: translate3d(118vw,100vh,0) rotate(var(--rocket-angle)); }
    84%  {           transform: translate3d(-82vw,-100vh,0) rotate(var(--rocket-angle)); animation-timing-function: steps(var(--rocket-steps), end); }
    84.1%{ opacity:0; }

    /* LEG 8 */
    87.5%{ opacity:0; transform: translate3d(112vw,74vh,0) rotate(var(--rocket-angle)); }
    87.6%{ opacity:1; transform: translate3d(112vw,74vh,0) rotate(var(--rocket-angle)); }
    96%  {           transform: translate3d(-88vw,-126vh,0) rotate(var(--rocket-angle)); animation-timing-function: steps(var(--rocket-steps), end); }
    100% { opacity:0; }
  }
}

/* === ROCKET === END === */