/* ---------- Animatable custom properties (for smooth per-layer motion) ---------- */
@property --fog1-x { syntax: '<length-percentage>'; inherits: false; initial-value: 0px; }
@property --fog1-y { syntax: '<length-percentage>'; inherits: false; initial-value: 0px; }
@property --fog2-x { syntax: '<length-percentage>'; inherits: false; initial-value: 0px; }
@property --fog2-y { syntax: '<length-percentage>'; inherits: false; initial-value: 0px; }
@property --fog3-x { syntax: '<length-percentage>'; inherits: false; initial-value: 0px; }
@property --fog3-y { syntax: '<length-percentage>'; inherits: false; initial-value: 0px; }

@property --starfar-x { syntax: '<length-percentage>'; inherits: false; initial-value: 0px; }
@property --starfar-y { syntax: '<length-percentage>'; inherits: false; initial-value: 0px; }
@property --starnear-x { syntax: '<length-percentage>'; inherits: false; initial-value: 0px; }
@property --starnear-y { syntax: '<length-percentage>'; inherits: false; initial-value: 0px; }

/* ---------- FAR STARS + FOG (one pseudo-element) ---------- */
#background::before {
  --tile: 220px;        /* star tile */
  --fog-tile: 900px;    /* fog tile size (bigger = softer) */
  content: "";
  position: absolute;
  inset: 0;
  z-index: 3;
  pointer-events: none;

  /* Top 3 layers = fog blobs (very soft) | bottom layer = your far stars */
  background-image:
    radial-gradient(closest-side at 30% 40%, rgba(255,255,255,0.2), rgba(255,255,255,0) 90%),
    radial-gradient(closest-side at 70% 65%, rgba(255,255,255,0.1), rgba(255,255,255,0) 88%),
    radial-gradient(closest-side at 40% 75%, rgba(255,255,255,0.3), rgba(255,255,255,0) 80%),

    radial-gradient(1px 1px at 10px 20px, #fff, transparent 1px),
    radial-gradient(1px 1px at 70px 40px, #fff, transparent 2px),
    radial-gradient(1px 1px at 130px 90px, #fff, transparent 1px),
    radial-gradient(1px 1px at 180px 160px, #fff, transparent 2px),
    radial-gradient(1px 1px at 30px 150px, #fff, transparent 1px),
    radial-gradient(1px 1px at 110px 10px, #fff, transparent 1px),
    radial-gradient(1px 1px at 160px 70px, #fff, transparent 2px),
    radial-gradient(1px 1px at 15px 95px, #fff, transparent 1px),
    radial-gradient(1px 1px at 90px 180px, #fff, transparent 2px),
    radial-gradient(1px 1px at 200px 50px, #fff, transparent 1px),
    radial-gradient(1px 1px at 175px 120px, #fff, transparent 1px),
    radial-gradient(1px 1px at 50px 80px, #fff, transparent 2px);

  background-size:
    var(--fog-tile) var(--fog-tile),
    var(--fog-tile) var(--fog-tile),
    var(--fog-tile) var(--fog-tile),

    var(--tile) var(--tile),
    var(--tile) var(--tile),
    var(--tile) var(--tile),
    var(--tile) var(--tile),
    var(--tile) var(--tile),
    var(--tile) var(--tile),
    var(--tile) var(--tile),
    var(--tile) var(--tile),
    var(--tile) var(--tile),
    var(--tile) var(--tile),
    var(--tile) var(--tile),
    var(--tile) var(--tile);

  /* Independent positions per layer (fog uses its own vars; stars use --starfar-*) */
  background-position:
    var(--fog1-x) var(--fog1-y),
    var(--fog2-x) var(--fog2-y),
    var(--fog3-x) var(--fog3-y),

    var(--starfar-x) var(--starfar-y),
    var(--starfar-x) var(--starfar-y),
    var(--starfar-x) var(--starfar-y),
    var(--starfar-x) var(--starfar-y),
    var(--starfar-x) var(--starfar-y),
    var(--starfar-x) var(--starfar-y),
    var(--starfar-x) var(--starfar-y),
    var(--starfar-x) var(--starfar-y),
    var(--starfar-x) var(--starfar-y),
    var(--starfar-x) var(--starfar-y),
    var(--starfar-x) var(--starfar-y),
    var(--starfar-x) var(--starfar-y);

  background-repeat: repeat;
  opacity: 0.35;

  /* Run multiple animations that only update variables */
  animation:
    fogDrift1 16s linear infinite,
    fogDrift2 22s linear infinite,
    fogDrift3 28s linear infinite,
    starDriftFarVars 40s linear infinite;
  will-change: background-position;
}

/* ---------- NEAR STARS ---------- */
#background::after {
  --tile: 240px;
  content: "";
  position: absolute;
  inset: 0;
  z-index: 4;
  pointer-events: none;
  background:
    radial-gradient(3px 3px at 25px 60px, #fff, transparent 3px),
    radial-gradient(2px 2px at 140px 30px, #fff, transparent 2px),
    radial-gradient(2px 2px at 80px 120px, #fff, transparent 2px),
    radial-gradient(2px 2px at 170px 170px, #fff, transparent 2px),
    radial-gradient(3px 3px at 60px 10px, #fff, transparent 3px),
    radial-gradient(4px 4px at 190px 95px, #fff, transparent 4px),
    radial-gradient(2px 2px at 10px 180px, #fff, transparent 2px),
    radial-gradient(2px 2px at 115px 165px, #fff, transparent 2px),
    radial-gradient(4px 4px at 45px 40px, #fff, transparent 4px),
    radial-gradient(2px 2px at 95px 75px, #fff, transparent 2px),
    radial-gradient(3px 3px at 155px 15px, #fff, transparent 3px),
    radial-gradient(2px 2px at 205px 145px, #fff, transparent 2px);
  background-size: var(--tile) var(--tile);
  background-position: var(--starnear-x) var(--starnear-y);
  background-repeat: repeat;
  opacity: 0.65;
  animation:
    starDriftNearVars 20s linear infinite,
    starTwinkle 3.5s ease-in-out infinite;
  will-change: background-position, opacity;
}

/* ---------- Keyframes that update ONLY variables (seamless tiling) ---------- */
@keyframes fogDrift1 {
  from { --fog1-x: 0px; --fog1-y: 0px; }
  to   { --fog1-x: calc(var(--fog-tile) * -1); --fog1-y: calc(var(--fog-tile) * -1); }
}
@keyframes fogDrift2 {
  from { --fog2-x: 0px; --fog2-y: 0px; }
  to   { --fog2-x: calc(var(--fog-tile) *  1); --fog2-y: calc(var(--fog-tile) * -1); }
}
@keyframes fogDrift3 {
  from { --fog3-x: 0px; --fog3-y: 0px; }
  to   { --fog3-x: calc(var(--fog-tile) * -1); --fog3-y: calc(var(--fog-tile) *  1); }
}

/* Stars (far/near) move exactly one tile for perfect looping */
@keyframes starDriftFarVars {
  from { --starfar-x: 0px; --starfar-y: 0px; }
  to   { --starfar-x: calc(var(--tile) * -1); --starfar-y: calc(var(--tile) * -1); }
}
@keyframes starDriftNearVars {
  from { --starnear-x: 0px; --starnear-y: 0px; }
  to   { --starnear-x: calc(var(--tile) * -1); --starnear-y: calc(var(--tile) * -1); }
}

/* Twinkle unchanged */
@keyframes starTwinkle {
  0%, 100% { opacity: 0.45; }
  50% { opacity: 1; }
}
